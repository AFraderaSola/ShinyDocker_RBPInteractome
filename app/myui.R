############################
######## Libraries #########
############################

library(shiny)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
# library(ggpubr)
library(plotly)
library(ggrepel)
library(tibble)
library(tidyr)
library(shinyBS)
library(DT)
library(mailtoR)
library(network)
library(scales)
library(sna)
library(intergraph)
library(ggparty)
library(ggraph)
library(igraph)
library(visNetwork)
library(shinythemes)
# library(tidyverse)
set.seed(666)
options(stringsAsFactors = FALSE)

############################
####### Variables ##########
############################

load("./InputFiles/01_All_InteractiveNetwork.RData")
load("./InputFiles/02_Splicing_InteractiveNetwork.RData")
load("./InputFiles/03_Export_InteractiveNetwork.RData")
load("./InputFiles/04_Ribosome_InteractiveNetwork.RData")
load("./InputFiles/05_Synthesis_InteractiveNetwork.RData")
load("./InputFiles/06_Metabolism_InteractiveNetwork.RData")
load("./InputFiles/07_Degradation_InteractiveNetwork.RData")

############################
######### Script ###########
############################

ui <-  navbarPage(title = HTML("<b>RINE</b>: <u>R</u>BP <u>I</u>nteractome <u>N</u>etwork <u>E</u>xplorer"),
                  theme = shinytheme("lumen"),
                  windowTitle = "Saccharomyces cerevisiae RBP interactome network explorer",
                  tabPanel("Welcome",
                           fluidRow(column(12,
                                           h2("Abstract"),
                                           p("RNA-binding proteins (RBPs) form highly diverse and dynamic ribonucleoprotein complexes,
                                             whose functions determine the molecular fate of the bound RNA. In the model organism S. cerevisiae, 
                                             the number of proteins identified as RBPs has largely increased over the 
                                             last decade. However, the cellular function for most of these novel RBPs
                                             still remains largely unexplored. We use mass spectrometry-based 
                                             quantitative proteomics to systematically identify protein-protein 
                                             interactions (PPIs) and RNA-dependent interactions (RDIs) to create a 
                                             novel data set for 40 RBPs that are associated with the mRNA life cycle.
                                             Domain, functional, and pathway enrichment analyses revealed an 
                                             overrepresentation of RNA functionalities among the enriched 
                                             interactors. Using our extensive PPI and RDI networks, we revealed 
                                             putative new members of RNA-associated pathways, as well as highlighted 
                                             potential new roles of several RBPs, such as within metabolism."))),
                           fluidRow(column(4,
                                           h3("Experimental design"),
                                           br(),
                                           img(src = "Figure1.png",  height = "100%", width = "100%"),
                                           br(),
                                           br(),
                                           br(),
                                           p(strong("RBPs immunoprecipitation screen design. (A)"),
                                             "The 40 selected target RBPs are shown under a schematic drawing of the broad RNA biology processes 
                                       they are involved in.Proteins marked with (*) are associated to multiple
                                       processes.",
                                             strong("(B)"),
                                             "Schematic representation of the immunoprecipitation screen experimental design.")),
                                    column(8,
                                           h3("KEGG analysis results"),
                                           br(),
                                           img(src = "Figure2.png", height = "100%", width = "100%"),
                                           br(),
                                           br(),
                                           p(strong("Heat map of the PPI and RDI KEGG terms."),
                                             "Each tile represents an overrepresented KEGG term (adjusted p-value < 0.05) and its colour gradient represents the gene ratio (enriched genes in term / total enriched genes). The first horizontal colour bar (Set) represent the PPI and RDI sets while the second (Bait) represents the bait RBP functional selection criteria. The vertical colour bar (Interactors) represents the global functionality the KEGG terms belong to."))),
                           fluidRow(column(12,
                                           tags$hr(style="border-color: darkgrey;"))),
                           fluidRow(column(12,
                                           strong("RNA-dependent interactome allows network-based assignment of RNA-binding protein function"),
                                           br(),
                                           br(),
                                           p("Albert Fradera-Sola",tags$sup("1"),",",
                                             "Emily Nischwitz",tags$sup("1"),",",
                                             "Marie Elisabeth Bayer",tags$sup("1"),",",
                                             "Katja Luck",tags$sup("2"),",",
                                             "Falk Butter",tags$sup("1,#"), style = "font-size:9pt;"),
                                           em("# Indicates correspondance,
                                           1 Quantitative Proteomics, Institute of Molecular Biology, Mainz, Germany,
                                              2 Integrative systems biology, Institute of Molecular Biology, 55128 Mainz, Germany",
                                              style = "font-size:8pt;"),
                                           br(),
                                           br(),
                                           p("App created by Albert Fradera-Sola in June 2022", style = "font-size:9pt;"),
                                           p("Comments and bug reports to the following e-mail: ", mailtoR(email = "A.FraderaSola@imb-mainz.de",
                                                                                                           subject = "Comments and bugs: RBP Interactome shiny app",
                                                                                                           text = "A.FraderaSola@imb-mainz.de"), style = "font-size:9pt;"),
                                           em("Last update: November 2022", style = "font-size:8pt;")))),
                  
                  tabPanel("All",
                           tabsetPanel(
                             tabPanel("PPI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("All_PPI_NodeColour", "Choose bait function:",
                                                                  choices =sort(unique(PPI_All_vis_nodes$Functionality)[-grep(unique(PPI_All_vis_nodes$Functionality),
                                                                                                                              pattern = "None",
                                                                                                                              x = unique(PPI_All_vis_nodes$Functionality))]),
                                                                  selected = sort(unique(PPI_All_vis_nodes$Functionality)[-grep(unique(PPI_All_vis_nodes$Functionality),
                                                                                                                                pattern = "None",
                                                                                                                                x = unique(PPI_All_vis_nodes$Functionality))])),
                                               h4("Size"),
                                               checkboxInput("All_PPI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("All_PPI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("All_PPI_EdgeColour", "Choose bait function:",
                                                                  choices =sort(unique(PPI_All_vis_edges$Functionality)),
                                                                  selected = sort(unique(PPI_All_vis_edges$Functionality))),
                                               h4("Thickness"),
                                               sliderInput("All_PPI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                               radioButtons("All_PPI_NetworkLayout", "Choose one:",
                                                            choiceNames = list(
                                                              "Davidson-Harel",
                                                              "Fruchterman-Reingold",
                                                              "GEM",
                                                              "Graphopt",
                                                              "Kamada-Kawai",
                                                              "Large graph layout",
                                                              "Randomly",
                                                              "Reingold-Tilford",
                                                              "Sugiyama",
                                                              "Circle",
                                                              "Grid",
                                                              "Sphere",
                                                              "Star"
                                                    
                                                            ),
                                                            choiceValues = list(
                                                              "layout_with_dh",
                                                              "layout_with_fr", 
                                                              "layout_with_gem",
                                                              "layout_with_graphopt",
                                                              "layout_with_kk",
                                                              "layout_with_lgl",
                                                              "layout_randomly",
                                                              "layout_as_tree",
                                                              "layout_with_sugiyama",
                                                              "layout_in_circle",
                                                              "layout_on_grid",
                                                              "layout_on_sphere",
                                                              "layout_as_star"
                                                            ),
                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("All_PPI_NodeDownload", "Nodes"),
                                               downloadButton("All_PPI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("All_PPI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(
                                        column(2,
                                               br()),
                                        column(10,
                                                      p(strong("IP screen protein-protein interaction (PPI) network."),
                                                        "RBP baits with a KEGG-associated function and their preys are depicted as a network.
                                                        Functions is highlighted with the nodes and/or edges colour, while the number of preys 
                                                        per bait is highlighted with the nodes size. Finally, the network is further customized
                                                        by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("RDI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("All_RDI_NodeColour", "Choose bait function:",
                                                                  choices =sort(unique(RDI_All_vis_nodes$Functionality)[-grep(unique(RDI_All_vis_nodes$Functionality),
                                                                                                                              pattern = "None",
                                                                                                                              x = unique(RDI_All_vis_nodes$Functionality))]),
                                                                  selected = sort(unique(RDI_All_vis_nodes$Functionality)[-grep(unique(RDI_All_vis_nodes$Functionality),
                                                                                                                                pattern = "None",
                                                                                                                                x = unique(RDI_All_vis_nodes$Functionality))])),
                                               h4("Size"),
                                               checkboxInput("All_RDI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("All_RDI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("All_RDI_EdgeColour", "Choose bait function:",
                                                                  choices =sort(unique(RDI_All_vis_edges$Functionality)),
                                                                  selected = sort(unique(RDI_All_vis_edges$Functionality))),
                                               h4("Thickness"),
                                               sliderInput("All_RDI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("All_RDI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("All_RDI_NodeDownload", "Nodes"),
                                               downloadButton("All_RDI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("All_RDI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("IP screen RNA-dependent interactions (RDI) network."),
                                                        "RBP baits with a KEGG-associated function and their preys are depicted as a network.
                                                        Functions is highlighted with the nodes and/or edges colour, while the number of preys 
                                                        per bait is highlighted with the nodes size. Finally, the network is further customized
                                                        by choosing the nodes size, the edges thickness and the network layout.")))))),
                  
                  tabPanel("Splicing",
                           tabsetPanel(
                             tabPanel("PPI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Splicing_PPI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(PPI_Splicing_vis_nodes$type)[-grep(unique(PPI_Splicing_vis_nodes$type),
                                                                                                                              pattern = "None",
                                                                                                                              x = unique(PPI_Splicing_vis_nodes$type))]),
                                                                  selected = sort(unique(PPI_Splicing_vis_nodes$type)[-grep(unique(PPI_Splicing_vis_nodes$type),
                                                                                                                                pattern = "None",
                                                                                                                                x = unique(PPI_Splicing_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Splicing_PPI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Splicing_PPI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Splicing_PPI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(PPI_Splicing_vis_edges$type)),
                                               #                    selected = sort(unique(PPI_Splicing_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Splicing_PPI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Splicing_PPI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Splicing_PPI_NodeDownload", "Nodes"),
                                               downloadButton("Splicing_PPI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Splicing_PPI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Splicing associated protein-protein interactors (PPI) sub-network."),
                                                        "RBP baits associated to splicing and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("RDI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Splicing_RDI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(RDI_Splicing_vis_nodes$type)[-grep(unique(RDI_Splicing_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(RDI_Splicing_vis_nodes$type))]),
                                                                  selected = sort(unique(RDI_Splicing_vis_nodes$type)[-grep(unique(RDI_Splicing_vis_nodes$type),
                                                                                                                            pattern = "None",
                                                                                                                            x = unique(RDI_Splicing_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Splicing_RDI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Splicing_RDI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Splicing_RDI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(RDI_Splicing_vis_edges$type)),
                                               #                    selected = sort(unique(RDI_Splicing_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Splicing_RDI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Splicing_RDI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Splicing_RDI_NodeDownload", "Nodes"),
                                               downloadButton("Splicing_RDI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Splicing_RDI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Splicing associated RNA-dependent interactors (RDI) sub-network."),
                                                        "RBP baits associated to splicing and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Combined (PPI + RDI)",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Splicing_Both_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Splicing_vis_nodes$type)[-grep(unique(Both_Splicing_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(Both_Splicing_vis_nodes$type))]),
                                                                  selected = "Bait"),
                                               h4("Size"),
                                               checkboxInput("Splicing_Both_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Splicing_Both_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Splicing_Both_EdgeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Splicing_vis_edges$type)),
                                                                  selected = sort(unique(Both_Splicing_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Splicing_Both_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Splicing_Both_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Splicing_Both_NodeDownload", "Nodes"),
                                               downloadButton("Splicing_Both_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Splicing_Both_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Splicing associated combined (PPI + RDI) sub-network."),
                                                        "RBP baits associated to splicing and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. The edge colour highlights
                                                        which set the prey belongs to. Finally, the network is further customized by choosing 
                                                        the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Complex data (CYC2008 - Wodak lab)",
                                      tabsetPanel(
                                        tabPanel("Complex Selection",
                                                 br(),
                                                 fluidRow(column(4,
                                                                 h3("Complex filtering"),
                                                                 sliderInput("Splicing_Complex_FilterSlider", 
                                                                             "By ratio (n_network / n_complex)",min = 0.5, max = 0.9, step = 0.1, value = 0.5),
                                                                 h3("Filtered complexes"),
                                                                 dataTableOutput("Splicing_Complex_WodakTable")),
                                                          column(8,
                                                                 br(),
                                                                 h3("Complex ratio dot plot"),
                                                                 plotlyOutput("Splicing_Complex_DotPlot", height = "500px"))),
                                                 fluidRow(column(4,
                                                                 h3("Complex selection"),
                                                                 uiOutput("Splicing_Complex_RadioButton")),
                                                          column(8,
                                                                 br(),
                                                                 h3(textOutput("Splicing_Complex_BarplotTitle")),
                                                                 plotlyOutput("Splicing_Complex_BarPlot", height = "500px")))),
                                        tabPanel("Complex Network",
                                                 br(),
                                                 fluidRow(
                                                   column(2,
                                                          h3("Node Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Splicing_Complex_NodeColour", "Choose bait functionalites:",
                                                                             choices = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member"),
                                                                             selected = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member")),
                                                          h4("Size"),
                                                          checkboxInput("Splicing_Complex_NodeSize", "Bait size by degree?", TRUE),
                                                          sliderInput("Splicing_Complex_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                                          h3("Edge Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Splicing_Complex_EdgeColour", "Choose bait functionalites:",
                                                                             choices =c("Both", "PPI", "RDI"),
                                                                             selected = c("Both", "PPI", "RDI")),
                                                          h4("Thickness"),
                                                          sliderInput("Splicing_Complex_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                                          h3("Network layout"),
                                                          bsCollapsePanel("Algorithm or shape",
                                                                          radioButtons("Splicing_Complex_NetworkLayout", "Choose one:",
                                                                                       choiceNames = list(
                                                                                         "Davidson-Harel",
                                                                                         "Fruchterman-Reingold",
                                                                                         "GEM",
                                                                                         "Graphopt",
                                                                                         "Kamada-Kawai",
                                                                                         "Large graph layout",
                                                                                         "Randomly",
                                                                                         "Reingold-Tilford",
                                                                                         "Sugiyama",
                                                                                         "Circle",
                                                                                         "Grid",
                                                                                         "Sphere",
                                                                                         "Star"
                                                                                         
                                                                                       ),
                                                                                       choiceValues = list(
                                                                                         "layout_with_dh",
                                                                                         "layout_with_fr", 
                                                                                         "layout_with_gem",
                                                                                         "layout_with_graphopt",
                                                                                         "layout_with_kk",
                                                                                         "layout_with_lgl",
                                                                                         "layout_randomly",
                                                                                         "layout_as_tree",
                                                                                         "layout_with_sugiyama",
                                                                                         "layout_in_circle",
                                                                                         "layout_on_grid",
                                                                                         "layout_on_sphere",
                                                                                         "layout_as_star"
                                                                                       ),
                                                                                       selected = "layout_with_fr")),
                                                          h3("Download"),
                                                          h4("Global network"),
                                                          downloadButton("Splicing_Complex_NodeDownload_v01", "Nodes"),
                                                          downloadButton("Splicing_Complex_EdgeDownload_v01", "Edges"),
                                                          h4("Interactor network"),
                                                          downloadButton("Splicing_Complex_NodeDownload_v02", "Nodes"),
                                                          downloadButton("Splicing_Complex_EdgeDownload_v02", "Edges")),
                                                   column(5,
                                                          h3(textOutput("Splicing_Complex_Networkv01Title")),
                                                          br(),
                                                          visNetworkOutput("Splicing_Complex_Interactive_Network_v01",height = "1000px")),
                                                   column(5,
                                                          h3(textOutput("Splicing_Complex_Networkv02Title")),
                                                          br(),
                                                          visNetworkOutput("Splicing_Complex_Interactive_Network_v02", height = "1000px"))),
                                                 br(),
                                                 fluidRow(column(2,
                                                                 br()),
                                                          column(5,
                                                                 p(strong("Global network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")),
                                                          column(5,
                                                                 p(strong("Interactor network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")))))))),
                  tabPanel("Export",
                           tabsetPanel(
                             tabPanel("PPI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Export_PPI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(PPI_Export_vis_nodes$type)[-grep(unique(PPI_Export_vis_nodes$type),
                                                                                                                             pattern = "None",
                                                                                                                             x = unique(PPI_Export_vis_nodes$type))]),
                                                                  selected = sort(unique(PPI_Export_vis_nodes$type)[-grep(unique(PPI_Export_vis_nodes$type),
                                                                                                                               pattern = "None",
                                                                                                                               x = unique(PPI_Export_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Export_PPI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Export_PPI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Export_PPI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(PPI_Export_vis_edges$type)),
                                               #                    selected = sort(unique(PPI_Export_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Export_PPI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Export_PPI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Export_PPI_NodeDownload", "Nodes"),
                                               downloadButton("Export_PPI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Export_PPI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Export associated protein-protein interactors (PPI) sub-network."),
                                                        "RBP baits associated to export and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("RDI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Export_RDI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(RDI_Export_vis_nodes$type)[-grep(unique(RDI_Export_vis_nodes$type),
                                                                                                                             pattern = "None",
                                                                                                                             x = unique(RDI_Export_vis_nodes$type))]),
                                                                  selected = sort(unique(RDI_Export_vis_nodes$type)[-grep(unique(RDI_Export_vis_nodes$type),
                                                                                                                               pattern = "None",
                                                                                                                               x = unique(RDI_Export_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Export_RDI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Export_RDI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Export_RDI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(RDI_Export_vis_edges$type)),
                                               #                    selected = sort(unique(RDI_Export_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Export_RDI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Export_RDI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Export_RDI_NodeDownload", "Nodes"),
                                               downloadButton("Export_RDI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Export_RDI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Export associated RNA-dependent interactors (RDI) sub-network."),
                                                        "RBP baits associated to export and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Combined (PPI + RDI)",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Export_Both_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Export_vis_nodes$type)[-grep(unique(Both_Export_vis_nodes$type),
                                                                                                                              pattern = "None",
                                                                                                                              x = unique(Both_Export_vis_nodes$type))]),
                                                                  selected = "Bait"),
                                               h4("Size"),
                                               checkboxInput("Export_Both_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Export_Both_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Export_Both_EdgeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Export_vis_edges$type)),
                                                                  selected = sort(unique(Both_Export_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Export_Both_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Export_Both_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Export_Both_NodeDownload", "Nodes"),
                                               downloadButton("Export_Both_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Export_Both_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Export associated combined (PPI + RDI) sub-network."),
                                                        "RBP baits associated to export and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. The edge colour highlights
                                                        which set the prey belongs to. Finally, the network is further customized by choosing 
                                                        the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Complex data (CYC2008 - Wodak lab)",
                                      tabsetPanel(
                                        tabPanel("Complex Selection",
                                                 br(),
                                                 fluidRow(column(4,
                                                                 h3("Complex filtering"),
                                                                 sliderInput("Export_Complex_FilterSlider", 
                                                                             "By ratio (n_network / n_complex)",min = 0.5, max = 0.9, step = 0.1, value = 0.5),
                                                                 h3("Filtered complexes"),
                                                                 dataTableOutput("Export_Complex_WodakTable")),
                                                          column(8,
                                                                 br(),
                                                                 h3("Complex ratio dot plot"),
                                                                 plotlyOutput("Export_Complex_DotPlot", height = "500px"))),
                                                 fluidRow(column(4,
                                                                 h3("Complex selection"),
                                                                 uiOutput("Export_Complex_RadioButton")),
                                                          column(8,
                                                                 br(),
                                                                 h3(textOutput("Export_Complex_BarplotTitle")),
                                                                 plotlyOutput("Export_Complex_BarPlot", height = "500px")))),
                                        tabPanel("Complex Network",
                                                 br(),
                                                 fluidRow(
                                                   column(2,
                                                          h3("Node Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Export_Complex_NodeColour", "Choose bait functionalites:",
                                                                             choices = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member"),
                                                                             selected = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member")),
                                                          h4("Size"),
                                                          checkboxInput("Export_Complex_NodeSize", "Bait size by degree?", TRUE),
                                                          sliderInput("Export_Complex_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                                          h3("Edge Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Export_Complex_EdgeColour", "Choose bait functionalites:",
                                                                             choices =c("Both", "PPI", "RDI"),
                                                                             selected = c("Both", "PPI", "RDI")),
                                                          h4("Thickness"),
                                                          sliderInput("Export_Complex_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                                          h3("Network layout"),
                                                          bsCollapsePanel("Algorithm or shape",
                                                                          radioButtons("Export_Complex_NetworkLayout", "Choose one:",
                                                                                       choiceNames = list(
                                                                                         "Davidson-Harel",
                                                                                         "Fruchterman-Reingold",
                                                                                         "GEM",
                                                                                         "Graphopt",
                                                                                         "Kamada-Kawai",
                                                                                         "Large graph layout",
                                                                                         "Randomly",
                                                                                         "Reingold-Tilford",
                                                                                         "Sugiyama",
                                                                                         "Circle",
                                                                                         "Grid",
                                                                                         "Sphere",
                                                                                         "Star"
                                                                                         
                                                                                       ),
                                                                                       choiceValues = list(
                                                                                         "layout_with_dh",
                                                                                         "layout_with_fr", 
                                                                                         "layout_with_gem",
                                                                                         "layout_with_graphopt",
                                                                                         "layout_with_kk",
                                                                                         "layout_with_lgl",
                                                                                         "layout_randomly",
                                                                                         "layout_as_tree",
                                                                                         "layout_with_sugiyama",
                                                                                         "layout_in_circle",
                                                                                         "layout_on_grid",
                                                                                         "layout_on_sphere",
                                                                                         "layout_as_star"
                                                                                       ),
                                                                                       selected = "layout_with_fr")),
                                                          h3("Download"),
                                                          h4("Global network"),
                                                          downloadButton("Export_Complex_NodeDownload_v01", "Nodes"),
                                                          downloadButton("Export_Complex_EdgeDownload_v01", "Edges"),
                                                          h4("Interactor network"),
                                                          downloadButton("Export_Complex_NodeDownload_v02", "Nodes"),
                                                          downloadButton("Export_Complex_EdgeDownload_v02", "Edges")),
                                                   column(5,
                                                          h3(textOutput("Export_Complex_Networkv01Title")),
                                                          br(),
                                                          visNetworkOutput("Export_Complex_Interactive_Network_v01",height = "1000px")),
                                                   column(5,
                                                          h3(textOutput("Export_Complex_Networkv02Title")),
                                                          br(),
                                                          visNetworkOutput("Export_Complex_Interactive_Network_v02", height = "1000px"))),
                                                 br(),
                                                 fluidRow(column(2,
                                                                 br()),
                                                          column(5,
                                                                 p(strong("Global network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")),
                                                          column(5,
                                                                 p(strong("Interactor network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")))))))),
                  tabPanel("Ribosome",
                           tabsetPanel(
                             tabPanel("PPI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Ribosome_PPI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(PPI_Ribosome_vis_nodes$type)[-grep(unique(PPI_Ribosome_vis_nodes$type),
                                                                                                                        pattern = "None",
                                                                                                                        x = unique(PPI_Ribosome_vis_nodes$type))]),
                                                                  selected = sort(unique(PPI_Ribosome_vis_nodes$type)[-grep(unique(PPI_Ribosome_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(PPI_Ribosome_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Ribosome_PPI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Ribosome_PPI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Ribosome_PPI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(PPI_Ribosome_vis_edges$type)),
                                               #                    selected = sort(unique(PPI_Ribosome_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Ribosome_PPI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Ribosome_PPI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Ribosome_PPI_NodeDownload", "Nodes"),
                                               downloadButton("Ribosome_PPI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Ribosome_PPI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Ribosome associated protein-protein interactors (PPI) sub-network."),
                                                        "RBP baits associated to ribosome and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("RDI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Ribosome_RDI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(RDI_Ribosome_vis_nodes$type)[-grep(unique(RDI_Ribosome_vis_nodes$type),
                                                                                                                        pattern = "None",
                                                                                                                        x = unique(RDI_Ribosome_vis_nodes$type))]),
                                                                  selected = sort(unique(RDI_Ribosome_vis_nodes$type)[-grep(unique(RDI_Ribosome_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(RDI_Ribosome_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Ribosome_RDI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Ribosome_RDI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Ribosome_RDI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(RDI_Ribosome_vis_edges$type)),
                                               #                    selected = sort(unique(RDI_Ribosome_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Ribosome_RDI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Ribosome_RDI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Ribosome_RDI_NodeDownload", "Nodes"),
                                               downloadButton("Ribosome_RDI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Ribosome_RDI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Ribosome associated RNA-dependent interactors (RDI) sub-network."),
                                                        "RBP baits associated to ribosome and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Combined (PPI + RDI)",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Ribosome_Both_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Ribosome_vis_nodes$type)[-grep(unique(Both_Ribosome_vis_nodes$type),
                                                                                                                         pattern = "None",
                                                                                                                         x = unique(Both_Ribosome_vis_nodes$type))]),
                                                                  selected = "Bait"),
                                               h4("Size"),
                                               checkboxInput("Ribosome_Both_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Ribosome_Both_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Ribosome_Both_EdgeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Ribosome_vis_edges$type)),
                                                                  selected = sort(unique(Both_Ribosome_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Ribosome_Both_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Ribosome_Both_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Ribosome_Both_NodeDownload", "Nodes"),
                                               downloadButton("Ribosome_Both_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Ribosome_Both_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Ribosome associated combined (PPI + RDI) sub-network."),
                                                        "RBP baits associated to ribosome and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. The edge colour highlights
                                                        which set the prey belongs to. Finally, the network is further customized by choosing 
                                                        the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Complex data (CYC2008 - Wodak lab)",
                                      tabsetPanel(
                                        tabPanel("Complex Selection",
                                                 br(),
                                                 fluidRow(column(4,
                                                                 h3("Complex filtering"),
                                                                 sliderInput("Ribosome_Complex_FilterSlider", 
                                                                             "By ratio (n_network / n_complex)",min = 0.5, max = 0.9, step = 0.1, value = 0.5),
                                                                 h3("Filtered complexes"),
                                                                 dataTableOutput("Ribosome_Complex_WodakTable")),
                                                          column(8,
                                                                 br(),
                                                                 h3("Complex ratio dot plot"),
                                                                 plotlyOutput("Ribosome_Complex_DotPlot", height = "500px"))),
                                                 fluidRow(column(4,
                                                                 h3("Complex selection"),
                                                                 uiOutput("Ribosome_Complex_RadioButton")),
                                                          column(8,
                                                                 br(),
                                                                 h3(textOutput("Ribosome_Complex_BarplotTitle")),
                                                                 plotlyOutput("Ribosome_Complex_BarPlot", height = "500px")))),
                                        tabPanel("Complex Network",
                                                 br(),
                                                 fluidRow(
                                                   column(2,
                                                          h3("Node Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Ribosome_Complex_NodeColour", "Choose bait functionalites:",
                                                                             choices = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member"),
                                                                             selected = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member")),
                                                          h4("Size"),
                                                          checkboxInput("Ribosome_Complex_NodeSize", "Bait size by degree?", TRUE),
                                                          sliderInput("Ribosome_Complex_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                                          h3("Edge Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Ribosome_Complex_EdgeColour", "Choose bait functionalites:",
                                                                             choices =c("Both", "PPI", "RDI"),
                                                                             selected = c("Both", "PPI", "RDI")),
                                                          h4("Thickness"),
                                                          sliderInput("Ribosome_Complex_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                                          h3("Network layout"),
                                                          bsCollapsePanel("Algorithm or shape",
                                                                          radioButtons("Ribosome_Complex_NetworkLayout", "Choose one:",
                                                                                       choiceNames = list(
                                                                                         "Davidson-Harel",
                                                                                         "Fruchterman-Reingold",
                                                                                         "GEM",
                                                                                         "Graphopt",
                                                                                         "Kamada-Kawai",
                                                                                         "Large graph layout",
                                                                                         "Randomly",
                                                                                         "Reingold-Tilford",
                                                                                         "Sugiyama",
                                                                                         "Circle",
                                                                                         "Grid",
                                                                                         "Sphere",
                                                                                         "Star"
                                                                                         
                                                                                       ),
                                                                                       choiceValues = list(
                                                                                         "layout_with_dh",
                                                                                         "layout_with_fr", 
                                                                                         "layout_with_gem",
                                                                                         "layout_with_graphopt",
                                                                                         "layout_with_kk",
                                                                                         "layout_with_lgl",
                                                                                         "layout_randomly",
                                                                                         "layout_as_tree",
                                                                                         "layout_with_sugiyama",
                                                                                         "layout_in_circle",
                                                                                         "layout_on_grid",
                                                                                         "layout_on_sphere",
                                                                                         "layout_as_star"
                                                                                       ),
                                                                                       selected = "layout_with_fr")),
                                                          h3("Download"),
                                                          h4("Global network"),
                                                          downloadButton("Ribosome_Complex_NodeDownload_v01", "Nodes"),
                                                          downloadButton("Ribosome_Complex_EdgeDownload_v01", "Edges"),
                                                          h4("Interactor network"),
                                                          downloadButton("Ribosome_Complex_NodeDownload_v02", "Nodes"),
                                                          downloadButton("Ribosome_Complex_EdgeDownload_v02", "Edges")),
                                                   column(5,
                                                          h3(textOutput("Ribosome_Complex_Networkv01Title")),
                                                          br(),
                                                          visNetworkOutput("Ribosome_Complex_Interactive_Network_v01",height = "1000px")),
                                                   column(5,
                                                          h3(textOutput("Ribosome_Complex_Networkv02Title")),
                                                          br(),
                                                          visNetworkOutput("Ribosome_Complex_Interactive_Network_v02", height = "1000px"))),
                                                 br(),
                                                 fluidRow(column(2,
                                                                 br()),
                                                          column(5,
                                                                 p(strong("Global network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")),
                                                          column(5,
                                                                 p(strong("Interactor network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")))))))),
                  tabPanel("Synthesis",
                           tabsetPanel(
                             tabPanel("PPI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Synthesis_PPI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(PPI_Synthesis_vis_nodes$type)[-grep(unique(PPI_Synthesis_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(PPI_Synthesis_vis_nodes$type))]),
                                                                  selected = sort(unique(PPI_Synthesis_vis_nodes$type)[-grep(unique(PPI_Synthesis_vis_nodes$type),
                                                                                                                            pattern = "None",
                                                                                                                            x = unique(PPI_Synthesis_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Synthesis_PPI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Synthesis_PPI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Synthesis_PPI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(PPI_Synthesis_vis_edges$type)),
                                               #                    selected = sort(unique(PPI_Synthesis_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Synthesis_PPI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Synthesis_PPI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Synthesis_PPI_NodeDownload", "Nodes"),
                                               downloadButton("Synthesis_PPI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Synthesis_PPI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Synthesis associated protein-protein interactors (PPI) sub-network."),
                                                        "RBP baits associated to synthesis and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("RDI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Synthesis_RDI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(RDI_Synthesis_vis_nodes$type)[-grep(unique(RDI_Synthesis_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(RDI_Synthesis_vis_nodes$type))]),
                                                                  selected = sort(unique(RDI_Synthesis_vis_nodes$type)[-grep(unique(RDI_Synthesis_vis_nodes$type),
                                                                                                                            pattern = "None",
                                                                                                                            x = unique(RDI_Synthesis_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Synthesis_RDI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Synthesis_RDI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Synthesis_RDI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(RDI_Synthesis_vis_edges$type)),
                                               #                    selected = sort(unique(RDI_Synthesis_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Synthesis_RDI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Synthesis_RDI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Synthesis_RDI_NodeDownload", "Nodes"),
                                               downloadButton("Synthesis_RDI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Synthesis_RDI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Synthesis associated RNA-dependent interactors (RDI) sub-network."),
                                                        "RBP baits associated to synthesis and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Combined (PPI + RDI)",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Synthesis_Both_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Synthesis_vis_nodes$type)[-grep(unique(Both_Synthesis_vis_nodes$type),
                                                                                                                           pattern = "None",
                                                                                                                           x = unique(Both_Synthesis_vis_nodes$type))]),
                                                                  selected = "Bait"),
                                               h4("Size"),
                                               checkboxInput("Synthesis_Both_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Synthesis_Both_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Synthesis_Both_EdgeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Synthesis_vis_edges$type)),
                                                                  selected = sort(unique(Both_Synthesis_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Synthesis_Both_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Synthesis_Both_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Synthesis_Both_NodeDownload", "Nodes"),
                                               downloadButton("Synthesis_Both_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Synthesis_Both_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Synthesis associated combined (PPI + RDI) sub-network."),
                                                        "RBP baits associated to synthesis and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. The edge colour highlights
                                                        which set the prey belongs to. Finally, the network is further customized by choosing 
                                                        the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Complex data (CYC2008 - Wodak lab)",
                                      tabsetPanel(
                                        tabPanel("Complex Selection",
                                                 br(),
                                                 fluidRow(column(4,
                                                                 h3("Complex filtering"),
                                                                 sliderInput("Synthesis_Complex_FilterSlider", 
                                                                             "By ratio (n_network / n_complex)",min = 0.5, max = 0.9, step = 0.1, value = 0.5),
                                                                 h3("Filtered complexes"),
                                                                 dataTableOutput("Synthesis_Complex_WodakTable")),
                                                          column(8,
                                                                 br(),
                                                                 h3("Complex ratio dot plot"),
                                                                 plotlyOutput("Synthesis_Complex_DotPlot", height = "500px"))),
                                                 fluidRow(column(4,
                                                                 h3("Complex selection"),
                                                                 uiOutput("Synthesis_Complex_RadioButton")),
                                                          column(8,
                                                                 br(),
                                                                 h3(textOutput("Synthesis_Complex_BarplotTitle")),
                                                                 plotlyOutput("Synthesis_Complex_BarPlot", height = "500px")))),
                                        tabPanel("Complex Network",
                                                 br(),
                                                 fluidRow(
                                                   column(2,
                                                          h3("Node Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Synthesis_Complex_NodeColour", "Choose bait functionalites:",
                                                                             choices = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member"),
                                                                             selected = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member")),
                                                          h4("Size"),
                                                          checkboxInput("Synthesis_Complex_NodeSize", "Bait size by degree?", TRUE),
                                                          sliderInput("Synthesis_Complex_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                                          h3("Edge Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Synthesis_Complex_EdgeColour", "Choose bait functionalites:",
                                                                             choices =c("Both", "PPI", "RDI"),
                                                                             selected = c("Both", "PPI", "RDI")),
                                                          h4("Thickness"),
                                                          sliderInput("Synthesis_Complex_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                                          h3("Network layout"),
                                                          bsCollapsePanel("Algorithm or shape",
                                                                          radioButtons("Synthesis_Complex_NetworkLayout", "Choose one:",
                                                                                       choiceNames = list(
                                                                                         "Davidson-Harel",
                                                                                         "Fruchterman-Reingold",
                                                                                         "GEM",
                                                                                         "Graphopt",
                                                                                         "Kamada-Kawai",
                                                                                         "Large graph layout",
                                                                                         "Randomly",
                                                                                         "Reingold-Tilford",
                                                                                         "Sugiyama",
                                                                                         "Circle",
                                                                                         "Grid",
                                                                                         "Sphere",
                                                                                         "Star"
                                                                                         
                                                                                       ),
                                                                                       choiceValues = list(
                                                                                         "layout_with_dh",
                                                                                         "layout_with_fr", 
                                                                                         "layout_with_gem",
                                                                                         "layout_with_graphopt",
                                                                                         "layout_with_kk",
                                                                                         "layout_with_lgl",
                                                                                         "layout_randomly",
                                                                                         "layout_as_tree",
                                                                                         "layout_with_sugiyama",
                                                                                         "layout_in_circle",
                                                                                         "layout_on_grid",
                                                                                         "layout_on_sphere",
                                                                                         "layout_as_star"
                                                                                       ),
                                                                                       selected = "layout_with_fr")),
                                                          h3("Download"),
                                                          h4("Global network"),
                                                          downloadButton("Synthesis_Complex_NodeDownload_v01", "Nodes"),
                                                          downloadButton("Synthesis_Complex_EdgeDownload_v01", "Edges"),
                                                          h4("Interactor network"),
                                                          downloadButton("Synthesis_Complex_NodeDownload_v02", "Nodes"),
                                                          downloadButton("Synthesis_Complex_EdgeDownload_v02", "Edges")),
                                                   column(5,
                                                          h3(textOutput("Synthesis_Complex_Networkv01Title")),
                                                          br(),
                                                          visNetworkOutput("Synthesis_Complex_Interactive_Network_v01",height = "1000px")),
                                                   column(5,
                                                          h3(textOutput("Synthesis_Complex_Networkv02Title")),
                                                          br(),
                                                          visNetworkOutput("Synthesis_Complex_Interactive_Network_v02", height = "1000px"))),
                                                 br(),
                                                 fluidRow(column(2,
                                                                 br()),
                                                          column(5,
                                                                 p(strong("Global network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")),
                                                          column(5,
                                                                 p(strong("Interactor network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")))))))),
                  tabPanel("Metabolism",
                           tabsetPanel(
                             tabPanel("PPI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Metabolism_PPI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(PPI_Metabolism_vis_nodes$type)[-grep(unique(PPI_Metabolism_vis_nodes$type),
                                                                                                                           pattern = "None",
                                                                                                                           x = unique(PPI_Metabolism_vis_nodes$type))]),
                                                                  selected = sort(unique(PPI_Metabolism_vis_nodes$type)[-grep(unique(PPI_Metabolism_vis_nodes$type),
                                                                                                                             pattern = "None",
                                                                                                                             x = unique(PPI_Metabolism_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Metabolism_PPI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Metabolism_PPI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Metabolism_PPI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(PPI_Metabolism_vis_edges$type)),
                                               #                    selected = sort(unique(PPI_Metabolism_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Metabolism_PPI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Metabolism_PPI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Metabolism_PPI_NodeDownload", "Nodes"),
                                               downloadButton("Metabolism_PPI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Metabolism_PPI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Metabolism associated protein-protein interactors (PPI) sub-network."),
                                                        "RBP baits associated to metabolism and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("RDI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Metabolism_RDI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(RDI_Metabolism_vis_nodes$type)[-grep(unique(RDI_Metabolism_vis_nodes$type),
                                                                                                                           pattern = "None",
                                                                                                                           x = unique(RDI_Metabolism_vis_nodes$type))]),
                                                                  selected = sort(unique(RDI_Metabolism_vis_nodes$type)[-grep(unique(RDI_Metabolism_vis_nodes$type),
                                                                                                                             pattern = "None",
                                                                                                                             x = unique(RDI_Metabolism_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Metabolism_RDI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Metabolism_RDI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Metabolism_RDI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(RDI_Metabolism_vis_edges$type)),
                                               #                    selected = sort(unique(RDI_Metabolism_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Metabolism_RDI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Metabolism_RDI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Metabolism_RDI_NodeDownload", "Nodes"),
                                               downloadButton("Metabolism_RDI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Metabolism_RDI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Metabolism associated RNA-dependent interactors (RDI) sub-network."),
                                                        "RBP baits associated to metabolism and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Combined (PPI + RDI)",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Metabolism_Both_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Metabolism_vis_nodes$type)[-grep(unique(Both_Metabolism_vis_nodes$type),
                                                                                                                            pattern = "None",
                                                                                                                            x = unique(Both_Metabolism_vis_nodes$type))]),
                                                                  selected = "Bait"),
                                               h4("Size"),
                                               checkboxInput("Metabolism_Both_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Metabolism_Both_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Metabolism_Both_EdgeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Metabolism_vis_edges$type)),
                                                                  selected = sort(unique(Both_Metabolism_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Metabolism_Both_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Metabolism_Both_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Metabolism_Both_NodeDownload", "Nodes"),
                                               downloadButton("Metabolism_Both_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Metabolism_Both_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Metabolism associated combined (PPI + RDI) sub-network."),
                                                        "RBP baits associated to metabolism and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. The edge colour highlights
                                                        which set the prey belongs to. Finally, the network is further customized by choosing 
                                                        the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Complex data (CYC2008 - Wodak lab)",
                                      tabsetPanel(
                                        tabPanel("Complex Selection",
                                                 br(),
                                                 fluidRow(column(4,
                                                                 h3("Complex filtering"),
                                                                 sliderInput("Metabolism_Complex_FilterSlider", 
                                                                             "By ratio (n_network / n_complex)",min = 0.5, max = 0.9, step = 0.1, value = 0.5),
                                                                 h3("Filtered complexes"),
                                                                 dataTableOutput("Metabolism_Complex_WodakTable")),
                                                          column(8,
                                                                 br(),
                                                                 h3("Complex ratio dot plot"),
                                                                 plotlyOutput("Metabolism_Complex_DotPlot", height = "500px"))),
                                                 fluidRow(column(4,
                                                                 h3("Complex selection"),
                                                                 uiOutput("Metabolism_Complex_RadioButton")),
                                                          column(8,
                                                                 br(),
                                                                 h3(textOutput("Metabolism_Complex_BarplotTitle")),
                                                                 plotlyOutput("Metabolism_Complex_BarPlot", height = "500px")))),
                                        tabPanel("Complex Network",
                                                 br(),
                                                 fluidRow(
                                                   column(2,
                                                          h3("Node Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Metabolism_Complex_NodeColour", "Choose bait functionalites:",
                                                                             choices = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member"),
                                                                             selected = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member")),
                                                          h4("Size"),
                                                          checkboxInput("Metabolism_Complex_NodeSize", "Bait size by degree?", TRUE),
                                                          sliderInput("Metabolism_Complex_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                                          h3("Edge Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Metabolism_Complex_EdgeColour", "Choose bait functionalites:",
                                                                             choices =c("Both", "PPI", "RDI"),
                                                                             selected = c("Both", "PPI", "RDI")),
                                                          h4("Thickness"),
                                                          sliderInput("Metabolism_Complex_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                                          h3("Network layout"),
                                                          bsCollapsePanel("Algorithm or shape",
                                                                          radioButtons("Metabolism_Complex_NetworkLayout", "Choose one:",
                                                                                       choiceNames = list(
                                                                                         "Davidson-Harel",
                                                                                         "Fruchterman-Reingold",
                                                                                         "GEM",
                                                                                         "Graphopt",
                                                                                         "Kamada-Kawai",
                                                                                         "Large graph layout",
                                                                                         "Randomly",
                                                                                         "Reingold-Tilford",
                                                                                         "Sugiyama",
                                                                                         "Circle",
                                                                                         "Grid",
                                                                                         "Sphere",
                                                                                         "Star"
                                                                                         
                                                                                       ),
                                                                                       choiceValues = list(
                                                                                         "layout_with_dh",
                                                                                         "layout_with_fr", 
                                                                                         "layout_with_gem",
                                                                                         "layout_with_graphopt",
                                                                                         "layout_with_kk",
                                                                                         "layout_with_lgl",
                                                                                         "layout_randomly",
                                                                                         "layout_as_tree",
                                                                                         "layout_with_sugiyama",
                                                                                         "layout_in_circle",
                                                                                         "layout_on_grid",
                                                                                         "layout_on_sphere",
                                                                                         "layout_as_star"
                                                                                       ),
                                                                                       selected = "layout_with_fr")),
                                                          h3("Download"),
                                                          h4("Global network"),
                                                          downloadButton("Metabolism_Complex_NodeDownload_v01", "Nodes"),
                                                          downloadButton("Metabolism_Complex_EdgeDownload_v01", "Edges"),
                                                          h4("Interactor network"),
                                                          downloadButton("Metabolism_Complex_NodeDownload_v02", "Nodes"),
                                                          downloadButton("Metabolism_Complex_EdgeDownload_v02", "Edges")),
                                                   column(5,
                                                          h3(textOutput("Metabolism_Complex_Networkv01Title")),
                                                          br(),
                                                          visNetworkOutput("Metabolism_Complex_Interactive_Network_v01",height = "1000px")),
                                                   column(5,
                                                          h3(textOutput("Metabolism_Complex_Networkv02Title")),
                                                          br(),
                                                          visNetworkOutput("Metabolism_Complex_Interactive_Network_v02", height = "1000px"))),
                                                 br(),
                                                 fluidRow(column(2,
                                                                 br()),
                                                          column(5,
                                                                 p(strong("Global network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")),
                                                          column(5,
                                                                 p(strong("Interactor network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")))))))),
                  tabPanel("Degradation",
                           tabsetPanel(
                             tabPanel("PPI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Degradation_PPI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(PPI_Degradation_vis_nodes$type)[-grep(unique(PPI_Degradation_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(PPI_Degradation_vis_nodes$type))]),
                                                                  selected = sort(unique(PPI_Degradation_vis_nodes$type)[-grep(unique(PPI_Degradation_vis_nodes$type),
                                                                                                                            pattern = "None",
                                                                                                                            x = unique(PPI_Degradation_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Degradation_PPI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Degradation_PPI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Degradation_PPI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(PPI_Degradation_vis_edges$type)),
                                               #                    selected = sort(unique(PPI_Degradation_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Degradation_PPI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Degradation_PPI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Degradation_PPI_NodeDownload", "Nodes"),
                                               downloadButton("Degradation_PPI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Degradation_PPI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Degradation associated protein-protein interactors (PPI) sub-network."),
                                                        "RBP baits associated to degradation and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("RDI",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Degradation_RDI_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(RDI_Degradation_vis_nodes$type)[-grep(unique(RDI_Degradation_vis_nodes$type),
                                                                                                                          pattern = "None",
                                                                                                                          x = unique(RDI_Degradation_vis_nodes$type))]),
                                                                  selected = sort(unique(RDI_Degradation_vis_nodes$type)[-grep(unique(RDI_Degradation_vis_nodes$type),
                                                                                                                            pattern = "None",
                                                                                                                            x = unique(RDI_Degradation_vis_nodes$type))])),
                                               h4("Size"),
                                               checkboxInput("Degradation_RDI_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Degradation_RDI_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               # h4("Colour"),
                                               # checkboxGroupInput("Degradation_RDI_EdgeColour", "Choose bait functionalites:",
                                               #                    choices =sort(unique(RDI_Degradation_vis_edges$type)),
                                               #                    selected = sort(unique(RDI_Degradation_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Degradation_RDI_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Degradation_RDI_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Degradation_RDI_NodeDownload", "Nodes"),
                                               downloadButton("Degradation_RDI_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Degradation_RDI_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Degradation associated RNA-dependent interactors (RDI) sub-network."),
                                                        "RBP baits associated to degradation and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. Finally, the network is 
                                                        further customized by choosing the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Combined (PPI + RDI)",
                                      br(),
                                      fluidRow(
                                        column(2,
                                               h3("Node Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Degradation_Both_NodeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Degradation_vis_nodes$type)[-grep(unique(Both_Degradation_vis_nodes$type),
                                                                                                                           pattern = "None",
                                                                                                                           x = unique(Both_Degradation_vis_nodes$type))]),
                                                                  selected = "Bait"),
                                               h4("Size"),
                                               checkboxInput("Degradation_Both_NodeSize", "Bait size by degree?", TRUE),
                                               sliderInput("Degradation_Both_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                               h3("Edge Attributes"),
                                               h4("Colour"),
                                               checkboxGroupInput("Degradation_Both_EdgeColour", "Choose bait functionalites:",
                                                                  choices =sort(unique(Both_Degradation_vis_edges$type)),
                                                                  selected = sort(unique(Both_Degradation_vis_edges$type))),
                                               h4("Thickness"),
                                               sliderInput("Degradation_Both_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                               h3("Network layout"),
                                               bsCollapsePanel("Algorithm or shape",
                                                               radioButtons("Degradation_Both_NetworkLayout", "Choose one:",
                                                                            choiceNames = list(
                                                                              "Davidson-Harel",
                                                                              "Fruchterman-Reingold",
                                                                              "GEM",
                                                                              "Graphopt",
                                                                              "Kamada-Kawai",
                                                                              "Large graph layout",
                                                                              "Randomly",
                                                                              "Reingold-Tilford",
                                                                              "Sugiyama",
                                                                              "Circle",
                                                                              "Grid",
                                                                              "Sphere",
                                                                              "Star"
                                                                              
                                                                            ),
                                                                            choiceValues = list(
                                                                              "layout_with_dh",
                                                                              "layout_with_fr", 
                                                                              "layout_with_gem",
                                                                              "layout_with_graphopt",
                                                                              "layout_with_kk",
                                                                              "layout_with_lgl",
                                                                              "layout_randomly",
                                                                              "layout_as_tree",
                                                                              "layout_with_sugiyama",
                                                                              "layout_in_circle",
                                                                              "layout_on_grid",
                                                                              "layout_on_sphere",
                                                                              "layout_as_star"
                                                                            ),
                                                                            selected = "layout_with_fr")),
                                               h3("Download"),
                                               downloadButton("Degradation_Both_NodeDownload", "Nodes"),
                                               downloadButton("Degradation_Both_EdgeDownload", "Edges")),
                                        column(10,
                                               visNetworkOutput("Degradation_Both_Interactive_Network",height = "1000px"))),
                                      br(),
                                      fluidRow(column(2,
                                                      br()),
                                               column(10,
                                                      p(strong("Degradation associated combined (PPI + RDI) sub-network."),
                                                        "RBP baits associated to degradation and their preys are depicted as a network.
                                                        Inclusion at interaction database and/or the RBP census is highlighted with the nodes colour, 
                                                        while the number of preys per bait is highlighted with the nodes size. The edge colour highlights
                                                        which set the prey belongs to. Finally, the network is further customized by choosing 
                                                        the nodes size, the edges thickness and the network layout.")))),
                             tabPanel("Complex data (CYC2008 - Wodak lab)",
                                      tabsetPanel(
                                        tabPanel("Complex Selection",
                                                 br(),
                                                 fluidRow(column(4,
                                                                 h3("Complex filtering"),
                                                                 sliderInput("Degradation_Complex_FilterSlider", 
                                                                             "By ratio (n_network / n_complex)",min = 0.5, max = 0.9, step = 0.1, value = 0.5),
                                                                 h3("Filtered complexes"),
                                                                 dataTableOutput("Degradation_Complex_WodakTable")),
                                                          column(8,
                                                                 br(),
                                                                 h3("Complex ratio dot plot"),
                                                                 plotlyOutput("Degradation_Complex_DotPlot", height = "500px"))),
                                                 fluidRow(column(4,
                                                                 h3("Complex selection"),
                                                                 uiOutput("Degradation_Complex_RadioButton")),
                                                          column(8,
                                                                 br(),
                                                                 h3(textOutput("Degradation_Complex_BarplotTitle")),
                                                                 plotlyOutput("Degradation_Complex_BarPlot", height = "500px")))),
                                        tabPanel("Complex Network",
                                                 br(),
                                                 fluidRow(
                                                   column(2,
                                                          h3("Node Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Degradation_Complex_NodeColour", "Choose bait functionalites:",
                                                                             choices = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member"),
                                                                             selected = c("Bait", "Bait & Complex member", "Prey", "Prey & Complex member")),
                                                          h4("Size"),
                                                          checkboxInput("Degradation_Complex_NodeSize", "Bait size by degree?", TRUE),
                                                          sliderInput("Degradation_Complex_NodeSliderSize", "",min = 0, max = 100, step = 10, value = 20),
                                                          h3("Edge Attributes"),
                                                          h4("Colour"),
                                                          checkboxGroupInput("Degradation_Complex_EdgeColour", "Choose bait functionalites:",
                                                                             choices =c("Both", "PPI", "RDI"),
                                                                             selected = c("Both", "PPI", "RDI")),
                                                          h4("Thickness"),
                                                          sliderInput("Degradation_Complex_EdgeThickness", "",min = 1, max = 10, step = 1, value = 5),
                                                          h3("Network layout"),
                                                          bsCollapsePanel("Algorithm or shape",
                                                                          radioButtons("Degradation_Complex_NetworkLayout", "Choose one:",
                                                                                       choiceNames = list(
                                                                                         "Davidson-Harel",
                                                                                         "Fruchterman-Reingold",
                                                                                         "GEM",
                                                                                         "Graphopt",
                                                                                         "Kamada-Kawai",
                                                                                         "Large graph layout",
                                                                                         "Randomly",
                                                                                         "Reingold-Tilford",
                                                                                         "Sugiyama",
                                                                                         "Circle",
                                                                                         "Grid",
                                                                                         "Sphere",
                                                                                         "Star"
                                                                                         
                                                                                       ),
                                                                                       choiceValues = list(
                                                                                         "layout_with_dh",
                                                                                         "layout_with_fr", 
                                                                                         "layout_with_gem",
                                                                                         "layout_with_graphopt",
                                                                                         "layout_with_kk",
                                                                                         "layout_with_lgl",
                                                                                         "layout_randomly",
                                                                                         "layout_as_tree",
                                                                                         "layout_with_sugiyama",
                                                                                         "layout_in_circle",
                                                                                         "layout_on_grid",
                                                                                         "layout_on_sphere",
                                                                                         "layout_as_star"
                                                                                       ),
                                                                                       selected = "layout_with_fr")),
                                                          h3("Download"),
                                                          h4("Global network"),
                                                          downloadButton("Degradation_Complex_NodeDownload_v01", "Nodes"),
                                                          downloadButton("Degradation_Complex_EdgeDownload_v01", "Edges"),
                                                          h4("Interactor network"),
                                                          downloadButton("Degradation_Complex_NodeDownload_v02", "Nodes"),
                                                          downloadButton("Degradation_Complex_EdgeDownload_v02", "Edges")),
                                                   column(5,
                                                          h3(textOutput("Degradation_Complex_Networkv01Title")),
                                                          br(),
                                                          visNetworkOutput("Degradation_Complex_Interactive_Network_v01",height = "1000px")),
                                                   column(5,
                                                          h3(textOutput("Degradation_Complex_Networkv02Title")),
                                                          br(),
                                                          visNetworkOutput("Degradation_Complex_Interactive_Network_v02", height = "1000px"))),
                                                 br(),
                                                 fluidRow(column(2,
                                                                 br()),
                                                          column(5,
                                                                 p(strong("Global network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout.")),
                                                          column(5,
                                                                 p(strong("Interactor network."),
                                                                   "RBP baits associated to the complex and their preys are depicted as a network.
                                                                   Node identity is highlighted with the colour, while the number of preys per bait 
                                                                   is highlighted with the nodes size. The edge colour highlights which set the prey 
                                                                   belongs to. Finally, the network is further customized by choosing the nodes size, 
                                                                   the edges thickness and the network layout."))))))))
)

